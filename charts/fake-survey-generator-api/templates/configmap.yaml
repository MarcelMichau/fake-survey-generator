apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "fake-survey-generator-api.fullname" . }}
  labels:
{{ include "fake-survey-generator-api.labels" . | indent 4 }}
data:
  {{- if .Values.azureDatabaseEnabled }}
    {{- if .Values.azureDatabaseUseActiveDirectoryAuthentication }}
  ConnectionStrings__SurveyContext: Server={{ .Values.databaseServer }};Initial Catalog={{ .Values.database }};Persist Security Info=False;MultipleActiveResultSets=False;Encrypt=True;TrustServerCertificate=False;Connection Timeout=30;Authentication=Active Directory Managed Identity;
    {{- else }}
  ConnectionStrings__SurveyContext: Server={{ .Values.databaseServer }};Initial Catalog={{ .Values.database }};Persist Security Info=False;User ID={{ .Values.user }};Password={{ .Values.password }};MultipleActiveResultSets=False;Encrypt=True;TrustServerCertificate=False;Connection Timeout=30;
    {{- end }}
  {{- else }}
  ConnectionStrings__SurveyContext: Server={{ .Values.databaseServer }};Database={{ .Values.database }};user id={{ .Values.user }};pwd={{ .Values.password }};ConnectRetryCount=0
  ASPNETCORE_ENVIRONMENT: Development
  {{- end }}
  Cache__RedisUrl: {{ .Values.redisUrl }}
  Cache__RedisPassword: {{ .Values.redisPassword }}
  Cache__RedisDefaultDatabase: "{{ .Values.redisDefaultDatabase }}"
  {{- if .Values.azureRedisCacheEnabled }}
  Cache__RedisSsl: "true"
  {{- else }}
  Cache__RedisSsl: "false"
  {{- end }}
  IDENTITY_PROVIDER_URL: {{ .Values.identityProviderUrl }}